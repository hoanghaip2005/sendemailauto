<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email Automation Tool</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>üöÄ Email Automation Tool</h1>
        <p>T·ª± ƒë·ªông g·ª≠i email t·ª´ Google Sheets</p>
    </header>

    <main class="container">
        <!-- Status Dashboard -->
        <section class="dashboard">
            <div class="card">
                <h2>üìä Th·ªëng k√™</h2>
                <div class="stats-grid">
                    <div class="stat-item">
                        <span class="stat-number" id="total-emails">0</span>
                        <span class="stat-label">T·ªïng s·ªë email</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="sent-emails">0</span>
                        <span class="stat-label">ƒê√£ g·ª≠i</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="failed-emails">0</span>
                        <span class="stat-label">Th·∫•t b·∫°i</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="success-rate">0%</span>
                        <span class="stat-label">T·ª∑ l·ªá th√†nh c√¥ng</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Control Panel -->
        <section class="controls">
            <div class="card">
                <h2>‚öôÔ∏è ƒêi·ªÅu khi·ªÉn</h2>
                <div class="control-buttons">
                    <button id="send-now" class="btn btn-accent">
                        <span class="btn-icon">üìß</span>
                        G·ª≠i ngay
                    </button>
                    <button id="refresh-data" class="btn btn-outline">
                        <span class="btn-icon">üîÑ</span>
                        L√†m m·ªõi d·ªØ li·ªáu
                    </button>
                    <button id="auth-gmail" class="btn btn-warning" style="display: none;">
                        <span class="btn-icon">üîë</span>
                        X√°c th·ª±c Gmail
                    </button>
                </div>
                
                <div class="scheduler-info">
                    <h3>‚òÅÔ∏è Cloud Scheduler</h3>
                    <p><strong>T√¨nh tr·∫°ng:</strong> <span class="scheduler-status">ƒêang ho·∫°t ƒë·ªông</span></p>
                    <p><strong>C·∫•u h√¨nh:</strong> Qu·∫£n l√Ω l·ªãch tr√¨nh trong Google Cloud Console</p>
                    <p><strong>Endpoint:</strong> <code>/api/send-email</code></p>
                    <a href="https://console.cloud.google.com/cloudscheduler" target="_blank" class="btn btn-small btn-outline">
                        <span class="btn-icon">üîó</span>
                        M·ªü Cloud Console
                    </a>
                </div>
            </div>
        </section>

        <!-- Status -->
        <section class="status">
            <div class="card">
                <h2>üì° Tr·∫°ng th√°i h·ªá th·ªëng</h2>
                <div class="status-indicators">
                    <div class="status-item">
                        <span class="status-dot" id="scheduler-status"></span>
                        <span>Cloud Scheduler: <span id="scheduler-text">ƒêang ho·∫°t ƒë·ªông</span></span>
                    </div>
                    <div class="status-item">
                        <span class="status-dot" id="sheets-status"></span>
                        <span>Google Sheets: <span id="sheets-text">Ki·ªÉm tra...</span></span>
                    </div>
                    <div class="status-item">
                        <span class="status-dot" id="gmail-status"></span>
                        <span>Gmail API: <span id="gmail-text">Ki·ªÉm tra...</span></span>
                    </div>
                </div>
                <div class="last-run">
                    <p>L·∫ßn ch·∫°y cu·ªëi: <span id="last-run">Ch∆∞a c√≥</span></p>
                </div>
            </div>
        </section>

        <!-- Email Preview -->
        <section class="preview">
            <div class="card">
                <h2>üìù Preview Email</h2>
                <div class="email-preview">
                    <div class="preview-header">
                        <strong>Ti√™u ƒë·ªÅ:</strong> <span id="preview-subject">ƒêang t·∫£i...</span>
                    </div>
                    <div class="preview-body">
                        <strong>N·ªôi dung:</strong>
                        <div id="preview-content">ƒêang t·∫£i n·ªôi dung email...</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Logs -->
        <section class="logs">
            <div class="card">
                <h2>üìã L·ªãch s·ª≠ g·ª≠i email</h2>
                <div class="logs-controls">
                    <button id="clear-logs" class="btn btn-small">X√≥a logs</button>
                    <button id="export-logs" class="btn btn-small btn-outline">Xu·∫•t logs</button>
                </div>
                <div class="logs-container">
                    <div id="logs-content">
                        <div class="log-item info">
                            <span class="log-time">${new Date().toLocaleString('vi-VN')}</span>
                            <span class="log-message">H·ªá th·ªëng ƒë√£ kh·ªüi ƒë·ªông</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 Email Automation Tool - Made with ‚ù§Ô∏è</p>
    </footer>

    <script src="script.js"></script>
</body>
</html>